@model GestiondeMatricula.ViewModels.CursoFiltroViewModel

@{
    ViewData["Title"] = "CatÃ¡logo de Cursos";
}

<div class="container mt-5">
    <div class="bg-blur shadow">
        <h2 class="mb-4 text-center">ðŸ“š CatÃ¡logo de Cursos</h2>

        <!-- Formulario de Filtros -->
        <form method="get" class="mb-4 p-3 border rounded bg-light">
            <div class="row g-3 align-items-end">
                <div class="col-md-3">
                    <label asp-for="Nombre" class="form-label"></label>
                    <input asp-for="Nombre" class="form-control" placeholder="Buscar por nombre o cÃ³digo...">
                </div>
                <div class="col-md-2">
                    <label asp-for="CreditosMin" class="form-label"></label>
                    <input asp-for="CreditosMin" class="form-control" min="1" max="10">
                </div>
                <div class="col-md-2">
                    <label asp-for="CreditosMax" class="form-label"></label>
                    <input asp-for="CreditosMax" class="form-control" min="1" max="10">
                </div>
                <div class="col-md-2">
                    <label asp-for="HorarioDesde" class="form-label"></label>
                    <input asp-for="HorarioDesde" class="form-control" type="time">
                </div>
                <div class="col-md-2">
                    <label asp-for="HorarioHasta" class="form-label"></label>
                    <input asp-for="HorarioHasta" class="form-control" type="time">
                </div>
                <div class="col-md-1 d-grid gap-2">
                    <button type="submit" class="btn btn-primary">Filtrar</button>
                    <a href="@Url.Action("Catalogo")" class="btn btn-secondary">Limpiar</a>
                </div>
            </div>
        </form>

        <!-- Lista de Cursos -->
        @if (Model.Cursos.Any())
        {
            <div class="row">
                @foreach (var curso in Model.Cursos)
                {
                    var cupoDisponible = curso.CupoMaximo - curso.Matriculas.Count(m => m.Estado == EstadoMatricula.Confirmada);

                    <div class="col-lg-6 col-xl-4 mb-4">
                        <div class="card h-100 border-primary shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title fw-bold">@curso.Nombre</h5>
                                <h6 class="card-subtitle mb-2 text-muted">CÃ³digo: @curso.Codigo</h6>
                                <p class="card-text mb-2">
                                    <span class="badge bg-info text-dark me-2">CrÃ©ditos: @curso.Creditos</span>
                                    <span class="badge bg-secondary me-2">Horario: @curso.HorarioInicio.ToString(@"hh\:mm") - @curso.HorarioFin.ToString(@"hh\:mm")</span>
                                </p>
                                <p>
                                    <strong>Cupo disponible:</strong>
                                    <span class="@(cupoDisponible > 0 ? "text-success fw-bold" : "text-danger fw-bold")">
                                        @cupoDisponible / @curso.CupoMaximo
                                    </span>
                                </p>
                            </div>
                            <div class="card-footer bg-white border-0 text-end">
                                <a href="@Url.Action("Detalle", new { id = curso.Id })" class="btn btn-outline-primary">
                                    Ver Detalles
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="alert alert-info text-center">
                No se encontraron cursos con los filtros aplicados.
            </div>
        }
    </div>
</div>